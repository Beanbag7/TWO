-- 修复设备借用系统外键约束问题
USE equipmentloansystem;

-- 1. 首先禁用外键检查
SET FOREIGN_KEY_CHECKS = 0;

-- 2. 清空所有表数据
TRUNCATE TABLE maintenance_records;
TRUNCATE TABLE damage_records;
TRUNCATE TABLE borrow_records;
TRUNCATE TABLE reservations;
TRUNCATE TABLE equipments;
TRUNCATE TABLE users;
TRUNCATE TABLE equipment_types;

-- 3. 重新插入设备类型数据（15种类型）
INSERT INTO equipment_types (type_name, max_borrow_days, description) VALUES
('单反相机', 3, '专业摄影设备，适合商业拍摄和艺术创作'),
('微单相机', 3, '轻便型无反相机，适合日常拍摄和旅行'),
('投影仪', 5, '办公会议演示设备，支持高清投影'),
('笔记本电脑', 7, '高性能办公笔记本，适合外出办公'),
('无人机', 7, '航拍摄像设备，用于空中拍摄'),
('录音设备', 5, '专业录音设备，适合会议和采访'),
('三脚架', 7, '相机支撑设备，稳定拍摄'),
('闪光灯', 5, '摄影补光设备，室内外拍摄必备'),
('移动硬盘', 3, '大容量存储设备，数据备份和传输'),
('打印机', 7, '办公打印设备，支持彩色和黑白打印'),
('扫描仪', 5, '文档扫描设备，高清扫描'),
('平板电脑', 7, '便携式平板设备，适合演示和展示'),
('摄像机', 5, '专业摄像设备，适合视频录制'),
('音响设备', 3, '扩音设备，适合会议和活动'),
('麦克风', 3, '收音设备，适合录音和直播');

-- 4. 重新插入用户数据（45个用户）
-- 管理员用户（5个）
INSERT INTO users (full_name, password, employee_student_id, phone_number, email, department, user_type) VALUES
('系统管理员', 'e10adc3949ba59abbe56e057f20f883e', 'ADMIN001', '13800138000', 'admin@edu.cn', '信息技术中心', '管理员'),
('设备管理员', 'e10adc3949ba59abbe56e057f20f883e', 'ADMIN002', '13800138001', 'equipment_admin@edu.cn', '资产管理处', '管理员'),
('审核管理员', 'e10adc3949ba59abbe56e057f20f883e', 'ADMIN003', '13800138002', 'review_admin@edu.cn', '教务处', '管理员'),
('维修管理员', 'e10adc3949ba59abbe56e057f20f883e', 'ADMIN004', '13800138003', 'maintenance_admin@edu.cn', '后勤处', '管理员'),
('数据管理员', 'e10adc3949ba59abbe56e057f20f883e', 'ADMIN005', '13800138004', 'data_admin@edu.cn', '信息中心', '管理员');

-- 教师用户（10个）
INSERT INTO users (full_name, password, employee_student_id, phone_number, email, department, user_type) VALUES
('王教授', 'e10adc3949ba59abbe56e057f20f883e', 'T2023001', '13900139001', 'wangprof@edu.cn', '计算机科学与技术学院', '教师'),
('李副教授', 'e10adc3949ba59abbe56e057f20f883e', 'T2023002', '13900139002', 'liassociate@edu.cn', '软件工程学院', '教师'),
('张讲师', 'e10adc3949ba59abbe56e057f20f883e', 'T2023003', '13900139003', 'zhanglect@edu.cn', '人工智能学院', '教师'),
('陈助教', 'e10adc3949ba59abbe56e057f20f883e', 'T2023004', '13900139004', 'chenassist@edu.cn', '数据科学学院', '教师'),
('刘研究员', 'e10adc3949ba59abbe56e057f20f883e', 'T2023005', '13900139005', 'liuresearch@edu.cn', '网络空间安全学院', '教师'),
('杨教授', 'e10adc3949ba59abbe56e057f20f883e', 'T2023006', '13900139006', 'yangprof@edu.cn', '电子信息学院', '教师'),
('周副教授', 'e10adc3949ba59abbe56e057f20f883e', 'T2023007', '13900139007', 'zhouassociate@edu.cn', '机械工程学院', '教师'),
('吴讲师', 'e10adc3949ba59abbe56e057f20f883e', 'T2023008', '13900139008', 'wulct@edu.cn', '材料科学与工程学院', '教师'),
('郑助教', 'e10adc3949ba59abbe56e057f20f883e', 'T2023009', '13900139009', 'zhengassist@edu.cn', '化学化工学院', '教师'),
('孙研究员', 'e10adc3949ba59abbe56e057f20f883e', 'T2023010', '13900139010', 'sunresearch@edu.cn', '生命科学学院', '教师');

-- 学生用户（20个）
INSERT INTO users (full_name, password, employee_student_id, phone_number, email, department, user_type) VALUES
('张明', 'e10adc3949ba59abbe56e057f20f883e', 'S2023001', '13800138010', 'zhangming@edu.cn', '计算机科学与技术学院', '学生'),
('李华', 'e10adc3949ba59abbe56e057f20f883e', 'S2023002', '13800138011', 'lihua@edu.cn', '软件工程学院', '学生'),
('王芳', 'e10adc3949ba59abbe56e057f20f883e', 'S2023003', '13800138012', 'wangfang@edu.cn', '人工智能学院', '学生'),
('赵强', 'e10adc3949ba59abbe56e057f20f883e', 'S2023004', '13800138013', 'zhaoqiang@edu.cn', '数据科学学院', '学生'),
('刘丽', 'e10adc3949ba59abbe56e057f20f883e', 'S2023005', '13800138014', 'liuli@edu.cn', '网络空间安全学院', '学生'),
('陈伟', 'e10adc3949ba59abbe56e057f20f883e', 'S2023006', '13800138015', 'chenwei@edu.cn', '电子信息学院', '学生'),
('杨敏', 'e10adc3949ba59abbe56e057f20f883e', 'S2023007', '13800138016', 'yangmin@edu.cn', '机械工程学院', '学生'),
('周杰', 'e10adc3949ba59abbe56e057f20f883e', 'S2023008', '13800138017', 'zhoujie@edu.cn', '材料科学与工程学院', '学生'),
('吴娜', 'e10adc3949ba59abbe56e057f20f883e', 'S2023009', '13800138018', 'wuna@edu.cn', '化学化工学院', '学生'),
('郑涛', 'e10adc3949ba59abbe56e057f20f883e', 'S2023010', '13800138019', 'zhengtao@edu.cn', '生命科学学院', '学生'),
('孙倩', 'e10adc3949ba59abbe56e057f20f883e', 'S2023011', '13800138020', 'sunqian@edu.cn', '医学部', '学生'),
('马超', 'e10adc3949ba59abbe56e057f20f883e', 'S2023012', '13800138021', 'machao@edu.cn', '商学院', '学生'),
('林静', 'e10adc3949ba59abbe56e057f20f883e', 'S2023013', '13800138022', 'linjing@edu.cn', '法学院', '学生'),
('黄磊', 'e10adc3949ba59abbe56e057f20f883e', 'S2023014', '13800138023', 'huanglei@edu.cn', '文学院', '学生'),
('徐燕', 'e10adc3949ba59abbe56e057f20f883e', 'S2023015', '13800138024', 'xuyan@edu.cn', '外国语学院', '学生'),
('朱军', 'e10adc3949ba59abbe56e057f20f883e', 'S2023016', '13800138025', 'zhujun@edu.cn', '艺术学院', '学生'),
('何伟', 'e10adc3949ba59abbe56e057f20f883e', 'S2023017', '13800138026', 'hewei@edu.cn', '体育学院', '学生'),
('高敏', 'e10adc3949ba59abbe56e057f20f883e', 'S2023018', '13800138027', 'gaomin@edu.cn', '教育学院', '学生'),
('唐磊', 'e10adc3949ba59abbe56e057f20f883e', 'S2023019', '13800138028', 'tanglei@edu.cn', '新闻传播学院', '学生'),
('宋佳', 'e10adc3949ba59abbe56e057f20f883e', 'S2023020', '13800138029', 'songjia@edu.cn', '历史学院', '学生');

-- 行政人员（5个）
INSERT INTO users (full_name, password, employee_student_id, phone_number, email, department, user_type) VALUES
('赵主任', 'e10adc3949ba59abbe56e057f20f883e', 'A2023001', '13700137001', 'zhaodirector@edu.cn', '教务处', '行政人员'),
('钱处长', 'e10adc3949ba59abbe56e057f20f883e', 'A2023002', '13700137002', 'qianhead@edu.cn', '学生处', '行政人员'),
('孙科长', 'e10adc3949ba59abbe56e057f20f883e', 'A2023003', '13700137003', 'sunsection@edu.cn', '财务处', '行政人员'),
('李管理员', 'e10adc3949ba59abbe56e057f20f883e', 'A2023004', '13700137004', 'liadmin@edu.cn', '图书馆', '行政人员'),
('周秘书', 'e10adc3949ba59abbe56e057f20f883e', 'A2023005', '13700137005', 'zhousecretary@edu.cn', '校长办公室', '行政人员');

-- 研究生（5个）
INSERT INTO users (full_name, password, employee_student_id, phone_number, email, department, user_type) VALUES
('周博士', 'e10adc3949ba59abbe56e057f20f883e', 'G2023001', '13600136001', 'zhouphd@edu.cn', '研究生院', '研究生'),
('吴硕士', 'e10adc3949ba59abbe56e057f20f883e', 'G2023002', '13600136002', 'wumaster@edu.cn', '研究生院', '研究生'),
('郑研究生', 'e10adc3949ba59abbe56e057f20f883e', 'G2023003', '13600136003', 'zhenggrad@edu.cn', '研究生院', '研究生'),
('王研究生', 'e10adc3949ba59abbe56e057f20f883e', 'G2023004', '13600136004', 'wanggrad@edu.cn', '研究生院', '研究生'),
('李研究生', 'e10adc3949ba59abbe56e057f20f883e', 'G2023005', '13600136005', 'ligrad@edu.cn', '研究生院', '研究生');

-- 黑名单用户（5个）
INSERT INTO users (full_name, password, employee_student_id, phone_number, email, department, user_type, is_blacklisted) VALUES
('马逾期', 'e10adc3949ba59abbe56e057f20f883e', 'S2023021', '13800138030', 'mayuqi@edu.cn', '计算机科学与技术学院', '学生', TRUE),
('杨失信', 'e10adc3949ba59abbe56e057f20f883e', 'S2023022', '13800138031', 'yangshixin@edu.cn', '软件工程学院', '学生', TRUE),
('张损坏', 'e10adc3949ba59abbe56e057f20f883e', 'S2023023', '13800138032', 'zhangsunhuai@edu.cn', '人工智能学院', '学生', TRUE),
('王违规', 'e10adc3949ba59abbe56e057f20f883e', 'S2023024', '13800138033', 'wangweigui@edu.cn', '数据科学学院', '学生', TRUE),
('李失约', 'e10adc3949ba59abbe56e057f20f883e', 'S2023025', '13800138034', 'lishiyue@edu.cn', '网络空间安全学院', '学生', TRUE);

-- 5. 重新插入设备数据（80台设备）
-- 单反相机类设备（10台）
INSERT INTO equipments (type_id, equipment_name, brand, model, serial_number, status, purchase_date, price, storage_location) VALUES
(1, '佳能 EOS R6', '佳能', 'EOS R6', 'CAN-R6-2024001', '可用', '2024-01-15', 15000.00, '摄影器材室 A区-01'),
(1, '佳能 EOS R6', '佳能', 'EOS R6', 'CAN-R6-2024002', '借出', '2024-01-15', 15000.00, '摄影器材室 A区-01'),
(1, '尼康 D850', '尼康', 'D850', 'NIK-D850-2024001', '可用', '2024-02-20', 20000.00, '摄影器材室 A区-02'),
(1, '尼康 D850', '尼康', 'D850', 'NIK-D850-2024002', '维护中', '2024-02-20', 20000.00, '维修中心'),
(1, '索尼 A7R IV', '索尼', 'A7R IV', 'SONY-A7R4-2024001', '可用', '2024-03-10', 25000.00, '摄影器材室 A区-03'),
(1, '佳能 5D Mark IV', '佳能', '5D Mark IV', 'CAN-5D4-2024001', '可用', '2024-01-05', 18000.00, '摄影器材室 A区-04'),
(1, '尼康 Z9', '尼康', 'Z9', 'NIK-Z9-2024001', '借出', '2024-04-01', 30000.00, '摄影器材室 A区-05'),
(1, '佳能 EOS R5', '佳能', 'EOS R5', 'CAN-R5-2024001', '可用', '2024-05-10', 25000.00, '摄影器材室 A区-06'),
(1, '索尼 A7S III', '索尼', 'A7S III', 'SONY-A7S3-2024001', '可用', '2024-06-15', 22000.00, '摄影器材室 A区-07'),
(1, '富士 GFX100', '富士', 'GFX100', 'FUJI-GFX100-2024001', '可用', '2024-07-01', 45000.00, '摄影器材室 A区-08');

-- 微单相机类设备（8台）
INSERT INTO equipments (type_id, equipment_name, brand, model, serial_number, status, purchase_date, price, storage_location) VALUES
(2, '索尼 A6400', '索尼', 'A6400', 'SONY-A6400-2024001', '可用', '2024-05-15', 8000.00, '摄影器材室 B区-01'),
(2, '富士 X-T4', '富士', 'X-T4', 'FUJI-XT4-2024001', '可用', '2024-05-20', 12000.00, '摄影器材室 B区-02'),
(2, '索尼 A7III', '索尼', 'A7III', 'SONY-A73-2024001', '借出', '2024-03-25', 18000.00, '摄影器材室 B区-03'),
(2, '佳能 EOS M50', '佳能', 'EOS M50', 'CAN-M50-2024001', '可用', '2024-04-10', 6000.00, '摄影器材室 B区-04'),
(2, '富士 X-S10', '富士', 'X-S10', 'FUJI-XS10-2024001', '可用', '2024-06-01', 9000.00, '摄影器材室 B区-05'),
(2, '索尼 ZV-E10', '索尼', 'ZV-E10', 'SONY-ZVE10-2024001', '借出', '2024-07-15', 7000.00, '摄影器材室 B区-06'),
(2, '松下 S5', '松下', 'S5', 'PANASONIC-S5-2024001', '可用', '2024-08-10', 14000.00, '摄影器材室 B区-07'),
(2, '奥林巴斯 E-M10', '奥林巴斯', 'E-M10', 'OLYMPUS-EM10-2024001', '可用', '2024-09-01', 5000.00, '摄影器材室 B区-08');

-- 投影仪类设备（8台）
INSERT INTO equipments (type_id, equipment_name, brand, model, serial_number, status, purchase_date, price, storage_location) VALUES
(3, '爱普生 CB-X06', '爱普生', 'CB-X06', 'EPSON-X06-2024001', '可用', '2024-02-15', 5000.00, '多媒体教室 A栋-101'),
(3, '爱普生 CB-X06', '爱普生', 'CB-X06', 'EPSON-X06-2024002', '可用', '2024-02-15', 5000.00, '多媒体教室 A栋-102'),
(3, '明基 W1070', '明基', 'W1070', 'BENQ-W1070-2024001', '借出', '2024-01-20', 6000.00, '多媒体教室 B栋-201'),
(3, '松下 PT-X320', '松下', 'PT-X320', 'PANASONIC-PTX320-2024001', '可用', '2024-03-15', 5500.00, '多媒体教室 B栋-202'),
(3, '索尼 VPL-EX455', '索尼', 'VPL-EX455', 'SONY-VPL455-2024001', '维护中', '2024-01-10', 7000.00, '维修中心'),
(3, '极米 H3S', '极米', 'H3S', 'XGIMI-H3S-2024001', '可用', '2024-08-01', 4500.00, '多媒体教室 C栋-301'),
(3, '坚果 J10', '坚果', 'J10', 'JMGUO-J10-2024001', '可用', '2024-09-15', 5000.00, '多媒体教室 C栋-302'),
(3, '当贝 X3', '当贝', 'X3', 'DANGBEI-X3-2024001', '借出', '2024-10-01', 6500.00, '多媒体教室 D栋-401');

-- 笔记本电脑类设备（12台）
INSERT INTO equipments (type_id, equipment_name, brand, model, serial_number, status, purchase_date, price, storage_location) VALUES
(4, '联想 ThinkPad X1', '联想', 'ThinkPad X1', 'LENOVO-TPX1-2024001', '可用', '2024-04-01', 10000.00, '机房1-01号机位'),
(4, '联想 ThinkPad X1', '联想', 'ThinkPad X1', 'LENOVO-TPX1-2024002', '借出', '2024-04-01', 10000.00, '机房1-02号机位'),
(4, '戴尔 XPS 15', '戴尔', 'XPS 15', 'DELL-XPS15-2024001', '可用', '2024-03-20', 12000.00, '机房1-03号机位'),
(4, '华硕 ZenBook', '华硕', 'ZenBook', 'ASUS-ZNB-2024001', '借出', '2024-05-01', 8000.00, '机房2-01号机位'),
(4, '华为 MateBook', '华为', 'MateBook', 'HUAWEI-MB-2024001', '可用', '2024-04-15', 9000.00, '机房2-02号机位'),
(4, '小米 Notebook', '小米', 'Notebook', 'XIAOMI-NB-2024001', '可用', '2024-05-10', 7000.00, '机房2-03号机位'),
(4, '苹果 MacBook Pro', '苹果', 'MacBook Pro', 'APPLE-MBP-2024001', '借出', '2024-06-20', 15000.00, '机房3-01号机位'),
(4, '微软 Surface', '微软', 'Surface', 'MS-SURFACE-2024001', '可用', '2024-07-01', 11000.00, '机房3-02号机位'),
(4, '惠普 Spectre', '惠普', 'Spectre', 'HP-SPECTRE-2024001', '可用', '2024-08-15', 9500.00, '机房4-01号机位'),
(4, '宏碁 Swift', '宏碁', 'Swift', 'ACER-SWIFT-2024001', '可用', '2024-09-10', 6500.00, '机房4-02号机位'),
(4, '戴尔 Latitude', '戴尔', 'Latitude', 'DELL-LATITUDE-2024001', '维护中', '2024-10-05', 8500.00, '维修中心'),
(4, '联想 Yoga', '联想', 'Yoga', 'LENOVO-YOGA-2024001', '可用', '2024-11-01', 7500.00, '机房5-01号机位');

-- 无人机类设备（6台）
INSERT INTO equipments (type_id, equipment_name, brand, model, serial_number, status, purchase_date, price, storage_location) VALUES
(5, '大疆 Mavic 3', '大疆', 'Mavic 3', 'DJI-MV3-2024001', '可用', '2024-02-28', 15000.00, '航拍设备室-专用柜1'),
(5, '大疆 Mavic 3', '大疆', 'Mavic 3', 'DJI-MV3-2024002', '借出', '2024-02-28', 15000.00, '航拍设备室-专用柜1'),
(5, '大疆 Air 2S', '大疆', 'Air 2S', 'DJI-AIR2S-2024001', '可用', '2024-03-15', 10000.00, '航拍设备室-专用柜2'),
(5, '大疆 Mini 3 Pro', '大疆', 'Mini 3 Pro', 'DJI-MN3P-2024001', '维护中', '2024-01-20', 6000.00, '维修中心'),
(5, '大疆 FPV', '大疆', 'FPV', 'DJI-FPV-2024001', '可用', '2024-08-15', 12000.00, '航拍设备室-专用柜3'),
(5, '大疆 Avata', '大疆', 'Avata', 'DJI-AVATA-2024001', '借出', '2024-09-20', 8000.00, '航拍设备室-专用柜4');

-- 录音设备（6台）
INSERT INTO equipments (type_id, equipment_name, brand, model, serial_number, status, purchase_date, price, storage_location) VALUES
(6, '索尼 ICD-UX570', '索尼', 'ICD-UX570', 'SONY-ICD570-2024001', '可用', '2024-01-15', 800.00, '录音设备室-01号位'),
(6, '索尼 ICD-UX570', '索尼', 'ICD-UX570', 'SONY-ICD570-2024002', '借出', '2024-01-15', 800.00, '录音设备室-02号位'),
(6, '奥林巴斯 WS-882', '奥林巴斯', 'WS-882', 'OLYMPUS-WS882-2024001', '可用', '2024-02-20', 600.00, '录音设备室-03号位'),
(6, 'Zoom H1n', 'Zoom', 'H1n', 'ZOOM-H1N-2024001', '可用', '2024-09-01', 1200.00, '录音设备室-04号位'),
(6, 'Tascam DR-05X', 'Tascam', 'DR-05X', 'TASCAM-DR05X-2024001', '借出', '2024-10-15', 1500.00, '录音设备室-05号位'),
(6, '罗德 NT-USB', '罗德', 'NT-USB', 'RODE-NTUSB-2024001', '可用', '2024-11-10', 1800.00, '录音设备室-01号位');

-- 三脚架（8台）
INSERT INTO equipments (type_id, equipment_name, brand, model, serial_number, status, purchase_date, price, storage_location) VALUES
(7, '曼富图 MK190X3', '曼富图', 'MK190X3', 'MANFROTTO-MK190-2024001', '可用', '2024-03-01', 1200.00, '配件室-A架-01'),
(7, '曼富图 MK190X3', '曼富图', 'MK190X3', 'MANFROTTO-MK190-2024002', '可用', '2024-03-01', 1200.00, '配件室-A架-02'),
(7, '曼富图 MK190X3', '曼富图', 'MK190X3', 'MANFROTTO-MK190-2024003', '借出', '2024-03-01', 1200.00, '配件室-A架-03'),
(7, '百诺 C2680TV1', '百诺', 'C2680TV1', 'BENRO-C2680-2024001', '可用', '2024-04-10', 1500.00, '配件室-B架-01'),
(7, '思锐 R2204', '思锐', 'R2204', 'SIRUI-R2204-2024001', '可用', '2024-05-20', 1000.00, '配件室-B架-02'),
(7, '捷信 GT2542', '捷信', 'GT2542', 'GITZO-GT2542-2024001', '可用', '2024-06-15', 3000.00, '配件室-C架-01'),
(7, '马小路 MT-5', '马小路', 'MT-5', 'MARSACE-MT5-2024001', '借出', '2024-07-20', 900.00, '配件室-C架-02'),
(7, '富图宝 X-4C', '富图宝', 'X-4C', 'FOTOPRO-X4C-2024001', '可用', '2024-08-25', 700.00, '配件室-D架-01');

-- 闪光灯（6台）
INSERT INTO equipments (type_id, equipment_name, brand, model, serial_number, status, purchase_date, price, storage_location) VALUES
(8, '神牛 V1', '神牛', 'V1', 'GODOX-V1-2024001', '可用', '2024-02-15', 1200.00, '灯光设备室-01'),
(8, '神牛 V1', '神牛', 'V1', 'GODOX-V1-2024002', '借出', '2024-02-15', 1200.00, '灯光设备室-02'),
(8, '永诺 YN685', '永诺', 'YN685', 'YONGNUO-YN685-2024001', '可用', '2024-03-20', 800.00, '灯光设备室-03'),
(8, '神牛 AD200Pro', '神牛', 'AD200Pro', 'GODOX-AD200P-2024001', '可用', '2024-11-01', 2500.00, '灯光设备室-04'),
(8, '索尼 HVL-F60RM', '索尼', 'HVL-F60RM', 'SONY-HVL60RM-2024001', '可用', '2024-12-01', 1800.00, '灯光设备室-05'),
(8, '佳能 600EX II-RT', '佳能', '600EX II-RT', 'CANON-600EX-2024001', '借出', '2024-05-10', 2000.00, '灯光设备室-06');

-- 移动硬盘（6台）
INSERT INTO equipments (type_id, equipment_name, brand, model, serial_number, status, purchase_date, price, storage_location) VALUES
(9, '西部数据 My Passport', '西部数据', 'My Passport', 'WD-MP-2024001', '可用', '2024-04-01', 600.00, '存储设备室-01号位'),
(9, '西部数据 My Passport', '西部数据', 'My Passport', 'WD-MP-2024002', '借出', '2024-04-01', 600.00, '存储设备室-02号位'),
(9, '希捷 Backup Plus', '希捷', 'Backup Plus', 'SEAGATE-BP-2024001', '可用', '2024-05-10', 550.00, '存储设备室-03号位'),
(9, '东芝 Canvio', '东芝', 'Canvio', 'TOSHIBA-CV-2024001', '可用', '2024-05-15', 500.00, '存储设备室-04号位'),
(9, '三星 T7', '三星', 'T7', 'SAMSUNG-T7-2024001', '借出', '2024-12-01', 800.00, '存储设备室-05号位'),
(9, '金士顿 XS2000', '金士顿', 'XS2000', 'KINGSTON-XS2000-2024001', '可用', '2024-06-20', 700.00, '存储设备室-06号位');

-- 其他设备（10台）
INSERT INTO equipments (type_id, equipment_name, brand, model, serial_number, status, purchase_date, price, storage_location) VALUES
(10, '惠普 LaserJet Pro', '惠普', 'LaserJet Pro', 'HP-LJ-2024001', '可用', '2024-01-10', 2500.00, '办公楼 A区-打印室'),
(10, '佳能 imageCLASS', '佳能', 'imageCLASS', 'CANON-IC-2024001', '借出', '2024-02-20', 3000.00, '办公楼 B区-打印室'),
(10, '爱普生 EcoTank', '爱普生', 'EcoTank', 'EPSON-ET-2024001', '可用', '2024-03-15', 2800.00, '办公楼 C区-打印室'),
(11, '佳能 CanoScan', '佳能', 'CanoScan', 'CANON-CS-2024001', '可用', '2024-02-10', 1500.00, '扫描设备室-01号机'),
(12, 'iPad Pro 12.9', '苹果', 'iPad Pro 12.9', 'APPLE-IPAD-2024001', '借出', '2024-04-20', 8000.00, '平板设备室-01号位'),
(12, '华为 MatePad Pro', '华为', 'MatePad Pro', 'HUAWEI-MTP-2024001', '可用', '2024-05-15', 5000.00, '平板设备室-02号位'),
(13, '索尼 FDR-AX53', '索尼', 'FDR-AX53', 'SONY-CAM-2024001', '可用', '2024-03-25', 9000.00, '摄像设备室-01号位'),
(13, '松下 HC-VX1', '松下', 'HC-VX1', 'PANASONIC-HCVX1-2024001', '借出', '2024-06-10', 11000.00, '摄像设备室-02号位'),
(14, 'JBL FLIP 5', 'JBL', 'FLIP 5', 'JBL-FLIP-2024001', '借出', '2024-01-15', 1000.00, '音响设备室-01号位'),
(15, '罗德 VideoMic', '罗德', 'VideoMic', 'RODE-VM-2024001', '可用', '2024-04-05', 1200.00, '音频设备室-01号位');

-- 6. 重新插入预约记录数据（40条记录）
-- 待审核的预约（10条）
INSERT INTO reservations (user_id, equipment_id, scheduled_borrow_date, scheduled_return_date, status, reservation_time) VALUES
(6, 1, '2025-12-12', '2025-12-15', '待审核', '2025-12-11 09:00:00'),
(7, 3, '2025-12-13', '2025-12-16', '待审核', '2025-12-11 10:30:00'),
(8, 5, '2025-12-14', '2025-12-17', '待审核', '2025-12-11 11:15:00'),
(9, 9, '2025-12-15', '2025-12-18', '待审核', '2025-12-11 14:20:00'),
(10, 13, '2025-12-16', '2025-12-19', '待审核', '2025-12-11 15:45:00'),
(11, 17, '2025-12-17', '2025-12-20', '待审核', '2025-12-11 16:30:00'),
(12, 19, '2025-12-18', '2025-12-21', '待审核', '2025-12-11 17:15:00'),
(13, 21, '2025-12-19', '2025-12-22', '待审核', '2025-12-11 18:00:00'),
(14, 23, '2025-12-20', '2025-12-23', '待审核', '2025-12-11 19:30:00'),
(15, 25, '2025-12-21', '2025-12-24', '待审核', '2025-12-11 20:15:00');

-- 已批准的预约（15条）
INSERT INTO reservations (user_id, equipment_id, scheduled_borrow_date, scheduled_return_date, status, reservation_time, approver_id, approval_time) VALUES
(16, 2, '2025-12-10', '2025-12-12', '已批准', '2025-12-09 08:00:00', 1, '2025-12-09 08:30:00'),
(17, 6, '2025-12-11', '2025-12-13', '已批准', '2025-12-09 09:30:00', 1, '2025-12-09 10:00:00'),
(18, 8, '2025-12-12', '2025-12-14', '已批准', '2025-12-09 10:15:00', 1, '2025-12-09 10:30:00'),
(19, 10, '2025-12-13', '2025-12-15', '已批准', '2025-12-09 11:45:00', 1, '2025-12-09 12:00:00'),
(20, 14, '2025-12-14', '2025-12-16', '已批准', '2025-12-09 13:20:00', 2, '2025-12-09 13:30:00'),
(21, 16, '2025-12-15', '2025-12-17', '已批准', '2025-12-09 14:30:00', 2, '2025-12-09 14:45:00'),
(22, 18, '2025-12-16', '2025-12-18', '已批准', '2025-12-09 15:15:00', 2, '2025-12-09 15:30:00'),
(23, 20, '2025-12-17', '2025-12-19', '已批准', '2025-12-09 16:45:00', 3, '2025-12-09 17:00:00'),
(24, 22, '2025-12-18', '2025-12-20', '已批准', '2025-12-09 17:30:00', 3, '2025-12-09 17:45:00'),
(25, 24, '2025-12-19', '2025-12-21', '已批准', '2025-12-09 18:15:00', 3, '2025-12-09 18:30:00'),
(26, 26, '2025-12-20', '2025-12-22', '已批准', '2025-12-09 19:00:00', 4, '2025-12-09 19:15:00'),
(27, 28, '2025-12-21', '2025-12-23', '已批准', '2025-12-09 20:30:00', 4, '2025-12-09 20:45:00'),
(28, 30, '2025-12-22', '2025-12-24', '已批准', '2025-12-09 21:15:00', 4, '2025-12-09 21:30:00'),
(29, 32, '2025-12-23', '2025-12-25', '已批准', '2025-12-09 22:00:00', 5, '2025-12-09 22:15:00'),
(30, 34, '2025-12-24', '2025-12-26', '已批准', '2025-12-09 23:30:00', 5, '2025-12-09 23:45:00');

-- 已拒绝的预约（8条）
INSERT INTO reservations (user_id, equipment_id, scheduled_borrow_date, scheduled_return_date, status, reservation_time, approver_id, approval_time, rejection_reason) VALUES
(31, 4, '2025-12-08', '2025-12-09', '已拒绝', '2025-12-07 09:00:00', 1, '2025-12-07 09:30:00', '用户处于黑名单，无法借用设备'),
(32, 7, '2025-12-09', '2025-12-10', '已拒绝', '2025-12-07 10:30:00', 1, '2025-12-07 11:00:00', '设备已被其他用户预约'),
(33, 11, '2025-12-10', '2025-12-11', '已拒绝', '2025-12-07 11:15:00', 2, '2025-12-07 11:45:00', '用户信用记录不良'),
(34, 15, '2025-12-11', '2025-12-12', '已拒绝', '2025-12-07 14:20:00', 2, '2025-12-07 14:50:00', '设备维护中，暂不可用'),
(35, 27, '2025-12-12', '2025-12-13', '已拒绝', '2025-12-07 15:45:00', 3, '2025-12-07 16:15:00', '超出最大借用天数限制'),
(36, 29, '2025-12-13', '2025-12-14', '已拒绝', '2025-12-07 16:30:00', 3, '2025-12-07 17:00:00', '设备已损坏，等待维修'),
(37, 31, '2025-12-14', '2025-12-15', '已拒绝', '2025-12-07 17:15:00', 4, '2025-12-07 17:45:00', '用户有逾期未还记录'),
(38, 33, '2025-12-15', '2025-12-16', '已拒绝', '2025-12-07 18:00:00', 4, '2025-12-07 18:30:00', '设备库存不足');

-- 已取消的预约（5条）
INSERT INTO reservations (user_id, equipment_id, scheduled_borrow_date, scheduled_return_date, status, reservation_time) VALUES
(39, 35, '2025-12-07', '2025-12-09', '已取消', '2025-12-06 14:20:00'),
(40, 36, '2025-12-06', '2025-12-08', '已取消', '2025-12-05 15:45:00'),
(41, 37, '2025-12-05', '2025-12-07', '已取消', '2025-12-04 16:30:00'),
(42, 38, '2025-12-04', '2025-12-06', '已取消', '2025-12-03 09:15:00'),
(43, 39, '2025-12-03', '2025-12-05', '已取消', '2025-12-02 10:45:00');

-- 已转借用的预约（2条）
INSERT INTO reservations (user_id, equipment_id, scheduled_borrow_date, scheduled_return_date, status, reservation_time, approver_id, approval_time) VALUES
(44, 40, '2025-12-01', '2025-12-04', '已转借用', '2025-11-30 09:00:00', 1, '2025-11-30 09:30:00'),
(45, 41, '2025-12-02', '2025-12-05', '已转借用', '2025-11-30 10:15:00', 2, '2025-11-30 10:45:00');

-- 7. 重新插入借用记录数据（50条记录）- 按正确顺序
-- 首先插入借用记录（50条）
INSERT INTO borrow_records (user_id, equipment_id, reservation_id, actual_borrow_time, expected_return_time, actual_return_time, borrow_status, checkout_staff_id, return_staff_id, notes) VALUES
(1, 1, NULL, '2025-12-01 09:00:00', '2025-12-04 09:00:00', '2025-12-03 16:30:00', '已归还', 1, 1, '正常归还'),
(2, 3, NULL, '2025-12-02 10:30:00', '2025-12-05 10:30:00', '2025-12-04 14:20:00', '已归还', 1, 2, '正常归还'),
(3, 5, NULL, '2025-12-03 14:15:00', '2025-12-06 14:15:00', '2025-12-05 11:45:00', '已归还', 2, 3, '正常归还'),
(4, 7, NULL, '2025-12-04 09:00:00', '2025-12-07 09:00:00', '2025-12-06 15:10:00', '已归还', 2, 4, '正常归还'),
(5, 9, NULL, '2025-12-05 10:30:00', '2025-12-08 10:30:00', '2025-12-07 13:40:00', '已归还', 3, 5, '正常归还'),
(6, 11, NULL, '2025-12-06 14:15:00', '2025-12-09 14:15:00', '2025-12-08 16:20:00', '已归还', 3, 1, '正常归还'),
(7, 13, NULL, '2025-12-07 09:00:00', '2025-12-10 09:00:00', '2025-12-09 14:50:00', '已归还', 4, 2, '正常归还'),
(8, 15, NULL, '2025-12-08 10:30:00', '2025-12-11 10:30:00', '2025-12-10 11:30:00', '已归还', 4, 3, '正常归还'),
(9, 17, NULL, '2025-12-09 14:15:00', '2025-12-12 14:15:00', '2025-12-11 17:00:00', '已归还', 5, 4, '正常归还'),
(10, 19, NULL, '2025-12-10 09:00:00', '2025-12-13 09:00:00', '2025-12-12 15:45:00', '已归还', 5, 5, '正常归还'),
(11, 21, NULL, '2025-12-11 10:30:00', '2025-12-14 10:30:00', '2025-12-13 14:20:00', '已归还', 1, 1, '正常归还'),
(12, 23, NULL, '2025-12-12 14:15:00', '2025-12-15 14:15:00', '2025-12-14 16:10:00', '已归还', 2, 2, '正常归还'),
(13, 25, NULL, '2025-12-13 09:00:00', '2025-12-16 09:00:00', '2025-12-15 15:30:00', '已归还', 3, 3, '正常归还'),
(14, 27, NULL, '2025-12-14 10:30:00', '2025-12-17 10:30:00', '2025-12-16 13:45:00', '已归还', 4, 4, '正常归还'),
(15, 29, NULL, '2025-12-15 14:15:00', '2025-12-18 14:15:00', '2025-12-17 17:20:00', '已归还', 5, 5, '正常归还'),
(26, 31, NULL, '2025-11-01 09:00:00', '2025-11-08 09:00:00', '2025-11-07 16:00:00', '已归还', 1, 1, '正常归还'),
(27, 32, 24, '2025-11-02 10:30:00', '2025-11-09 10:30:00', '2025-11-08 15:30:00', '已归还', 2, 2, '正常归还'),
(28, 33, NULL, '2025-11-03 14:15:00', '2025-11-10 14:15:00', '2025-11-09 17:20:00', '已归还', 3, 3, '正常归还'),
(29, 34, NULL, '2025-11-05 09:00:00', '2025-11-12 09:00:00', '2025-11-11 14:15:00', '已归还', 4, 4, '正常归还'),
(30, 35, NULL, '2025-11-06 10:30:00', '2025-11-13 10:30:00', '2025-11-12 16:45:00', '已归还', 5, 5, '正常归还'),
(31, 36, NULL, '2025-11-20 09:00:00', '2025-11-23 09:00:00', '2025-11-25 10:00:00', '逾期', 1, 1, '逾期归还'),
(32, 37, NULL, '2025-11-25 10:30:00', '2025-11-28 10:30:00', '2025-11-30 09:30:00', '逾期', 2, 2, '逾期归还'),
(33, 38, NULL, '2025-11-15 14:20:00', '2025-11-18 14:20:00', '2025-11-20 15:45:00', '逾期', 3, 3, '逾期归还'),
(34, 39, NULL, '2025-11-10 09:00:00', '2025-11-13 09:00:00', '2025-11-15 11:20:00', '逾期', 4, 4, '逾期归还'),
(35, 40, NULL, '2025-11-05 10:30:00', '2025-11-08 10:30:00', '2025-11-10 14:30:00', '逾期', 5, 5, '逾期归还'),
(36, 41, NULL, '2025-10-20 09:00:00', '2025-10-23 09:00:00', '2025-10-25 10:15:00', '逾期', 1, 1, '逾期归还'),
(37, 42, NULL, '2025-10-25 10:30:00', '2025-10-28 10:30:00', '2025-10-30 11:45:00', '逾期', 2, 2, '逾期归还'),
(38, 43, NULL, '2025-10-15 14:20:00', '2025-10-18 14:20:00', '2025-10-20 16:30:00', '逾期', 3, 3, '逾期归还'),
(39, 44, NULL, '2025-12-08 09:00:00', '2025-12-11 09:00:00', '2025-12-10 14:20:00', '损坏', 4, 4, '设备损坏'),
(40, 45, NULL, '2025-12-09 10:30:00', '2025-12-12 10:30:00', '2025-12-11 15:45:00', '损坏', 5, 5, '设备损坏'),
(41, 46, NULL, '2025-10-01 09:00:00', '2025-10-08 09:00:00', '2025-10-07 15:30:00', '已归还', 1, 1, '正常归还'),
(42, 47, NULL, '2025-10-02 10:30:00', '2025-10-09 10:30:00', '2025-10-08 14:20:00', '已归还', 2, 2, '正常归还'),
(43, 48, NULL, '2025-10-03 14:15:00', '2025-10-10 14:15:00', '2025-10-09 16:45:00', '已归还', 3, 3, '正常归还'),
(44, 49, NULL, '2025-10-05 09:00:00', '2025-10-12 09:00:00', '2025-10-11 13:15:00', '已归还', 4, 4, '正常归还'),
(45, 50, NULL, '2025-10-06 10:30:00', '2025-10-13 10:30:00', '2025-10-12 15:00:00', '已归还', 5, 5, '正常归还'),
(6, 51, NULL, '2025-09-01 09:00:00', '2025-09-04 09:00:00', '2025-09-03 16:20:00', '已归还', 1, 1, '正常归还'),
(7, 52, NULL, '2025-09-02 10:30:00', '2025-09-09 10:30:00', '2025-09-08 14:45:00', '已归还', 2, 2, '正常归还'),
(8, 53, NULL, '2025-09-03 14:15:00', '2025-09-10 14:15:00', '2025-09-09 11:30:00', '已归还', 3, 3, '正常归还'),
(9, 54, NULL, '2025-09-04 09:00:00', '2025-09-11 09:00:00', '2025-09-10 15:15:00', '已归还', 4, 4, '正常归还'),
(10, 55, NULL, '2025-09-05 10:30:00', '2025-09-12 10:30:00', '2025-09-11 16:00:00', '已归还', 5, 5, '正常归还'),
(16, 2, 11, '2025-12-10 09:00:00', '2025-12-12 17:00:00', NULL, '使用中', 1, NULL, '当前借用'),
(17, 6, 12, '2025-12-11 10:30:00', '2025-12-13 17:00:00', NULL, '使用中', 1, NULL, '当前借用'),
(18, 8, 13, '2025-12-12 14:15:00', '2025-12-14 17:00:00', NULL, '使用中', 2, NULL, '当前借用'),
(19, 10, 14, '2025-12-13 09:00:00', '2025-12-15 17:00:00', NULL, '使用中', 2, NULL, '当前借用'),
(20, 14, 15, '2025-12-14 10:30:00', '2025-12-16 17:00:00', NULL, '使用中', 3, NULL, '当前借用'),
(21, 16, 16, '2025-12-15 08:30:00', '2025-12-17 17:00:00', NULL, '使用中', 3, NULL, '当前借用'),
(22, 18, 17, '2025-12-16 15:45:00', '2025-12-18 17:00:00', NULL, '使用中', 4, NULL, '当前借用'),
(23, 20, 18, '2025-12-17 11:20:00', '2025-12-19 17:00:00', NULL, '使用中', 4, NULL, '当前借用'),
(24, 22, 19, '2025-12-18 14:10:00', '2025-12-20 17:00:00', NULL, '使用中', 5, NULL, '当前借用'),
(25, 24, 20, '2025-12-19 09:45:00', '2025-12-21 17:00:00', NULL, '使用中', 5, NULL, '当前借用');

-- 8. 重新插入损坏记录数据（15条记录）- 使用有效的借用记录ID
INSERT INTO damage_records (borrow_record_id, reported_by, damage_description, severity, repair_cost, is_resolved, damage_time, resolution_notes) VALUES
(31, 1, '镜头摔裂，无法正常对焦', '重度', 1500.00, TRUE, '2025-11-15 10:30:00', '已更换镜头组件'),
(32, 2, '机身划痕，外观受损', '轻度', 200.00, TRUE, '2025-11-18 14:20:00', '已修复外观'),
(33, 3, '电池仓卡扣损坏', '中度', 500.00, TRUE, '2025-11-22 09:15:00', '已更换电池仓卡扣'),
(34, 4, '屏幕碎裂，显示异常', '重度', 2500.00, FALSE, '2025-11-25 11:45:00', '等待屏幕配件'),
(35, 5, '充电接口接触不良', '轻度', 150.00, TRUE, '2025-11-28 16:30:00', '已修复充电接口'),
(36, 1, '云台电机故障，无法稳定拍摄', '重度', 3000.00, TRUE, '2025-11-30 13:20:00', '已更换云台电机'),
(37, 2, '存储卡槽损坏，无法读取SD卡', '中度', 800.00, FALSE, '2025-12-02 10:10:00', '等待存储卡槽配件'),
(38, 3, '按键失灵，部分功能无法使用', '轻度', 300.00, TRUE, '2025-12-05 15:40:00', '已更换按键模块'),
(39, 4, '扬声器损坏，声音失真', '中度', 600.00, TRUE, '2025-12-07 09:25:00', '已更换扬声器单元'),
(40, 5, '硬盘读写速度异常', '中度', 400.00, TRUE, '2025-12-09 14:15:00', '已修复硬盘接口'),
(41, 1, '投影仪灯泡老化，亮度不足', '中度', 800.00, TRUE, '2025-11-10 11:30:00', '已更换投影仪灯泡'),
(42, 2, '打印机卡纸频繁', '轻度', 200.00, TRUE, '2025-11-12 15:45:00', '已清理打印机内部'),
(43, 3, '三脚架云台松动', '轻度', 100.00, TRUE, '2025-11-14 09:20:00', '已紧固云台螺丝'),
(44, 4, '闪光灯无法触发', '中度', 350.00, TRUE, '2025-11-16 16:10:00', '已修复闪光灯电路'),
(45, 5, '麦克风灵敏度降低', '轻度', 180.00, TRUE, '2025-11-18 13:40:00', '已清洁麦克风振膜');

-- 9. 重新插入维修记录数据（20条记录）
-- 已完成的维修（15条）
INSERT INTO maintenance_records (equipment_id, damage_record_id, start_date, completion_date, expected_completion_date, maintenance_status, maintenance_description, technician, cost, notes) VALUES
(4, 1, '2025-11-15', '2025-11-20', '2025-11-20', '已修复', '更换镜头组件，重新校准对焦系统', '李技师', 1200.00, '测试各项功能正常'),
(8, 2, '2025-11-18', '2025-11-20', '2025-11-20', '已修复', '机身外壳更换，外观翻新', '王技师', 180.00, '清洁保养完成'),
(12, 3, '2025-11-22', '2025-11-25', '2025-11-25', '已修复', '更换电池仓卡扣组件', '张技师', 450.00, '电池安装正常'),
(16, 5, '2025-11-28', '2025-11-30', '2025-11-30', '已修复', '清洁充电接口，更换触点', '赵技师', 100.00, '充电功能恢复正常'),
(20, 6, '2025-11-30', '2025-12-05', '2025-12-05', '已修复', '更换云台电机系统，重新校准', '刘技师', 2800.00, '飞行测试正常'),
(24, 8, '2025-12-05', '2025-12-08', '2025-12-08', '已修复', '更换按键模块，功能测试', '陈技师', 250.00, '各项操作正常'),
(28, 9, '2025-12-07', '2025-12-09', '2025-12-09', '已修复', '更换扬声器单元，音频测试', '杨技师', 550.00, '音质恢复正常'),
(32, 10, '2025-12-09', '2025-12-11', '2025-12-11', '已修复', '修复硬盘接口，测试读写速度', '周技师', 350.00, '读写速度正常'),
(36, 11, '2025-11-10', '2025-11-15', '2025-11-15', '已修复', '更换投影仪灯泡，调整亮度', '吴技师', 750.00, '亮度恢复正常'),
(40, 12, '2025-11-12', '2025-11-14', '2025-11-14', '已修复', '清理打印机内部，调整纸张路径', '郑技师', 150.00, '打印测试正常'),
(44, 13, '2025-11-14', '2025-11-15', '2025-11-15', '已修复', '紧固云台螺丝，调整阻尼', '孙技师', 80.00, '稳定性测试通过'),
(48, 14, '2025-11-16', '2025-11-18', '2025-11-18', '已修复', '修复闪光灯电路，更换电容', '马技师', 300.00, '闪光测试正常'),
(52, 15, '2025-11-18', '2025-11-19', '2025-11-19', '已修复', '清洁麦克风振膜，调整灵敏度', '林技师', 150.00, '录音测试正常'),
(56, NULL, '2025-11-01', '2025-11-05', '2025-11-05', '已修复', '定期保养维护，清洁内部灰尘', '黄技师', 200.00, '设备运行正常'),
(60, NULL, '2025-11-05', '2025-11-08', '2025-11-08', '已修复', '固件升级，性能优化', '徐技师', 0.00, '软件版本更新完成');

-- 正在进行的维修（3条）
INSERT INTO maintenance_records (equipment_id, damage_record_id, start_date, expected_completion_date, maintenance_status, maintenance_description, technician, cost) VALUES
(4, 4, '2025-11-25', '2025-12-10', '维修中', '等待屏幕配件到货，准备更换显示屏总成', '李技师', 2200.00),
(8, 7, '2025-12-02', '2025-12-12', '维修中', '订购新的存储卡槽，等待到货后进行更换', '王技师', 750.00),
(12, NULL, '2025-12-10', '2025-12-15', '维修中', '设备异常噪音，需拆机检查', '张技师', 0.00);

-- 报废记录（2条）
INSERT INTO maintenance_records (equipment_id, damage_record_id, start_date, completion_date, maintenance_status, maintenance_description, technician, cost) VALUES
(2, NULL, '2025-10-15', '2025-10-15', '已报废', '设备老化严重，维修成本过高，经评估建议报废处理', '报废管理员', 0.00),
(6, NULL, '2025-11-10', '2025-11-10', '已报废', '进水损坏，主板烧毁，无法修复，作报废处理', '报废管理员', 0.00);

-- 10. 更新设备状态确保一致性
-- 更新借出状态的设备
UPDATE equipments SET status = '借出' WHERE equipment_id IN (2, 6, 8, 10, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34);

-- 更新维护中的设备
UPDATE equipments SET status = '维护中' WHERE equipment_id IN (4, 8, 12);

-- 更新报废设备状态
UPDATE equipments SET status = '已报废' WHERE equipment_id IN (2, 6);

-- 11. 重新启用外键检查
SET FOREIGN_KEY_CHECKS = 1;

-- 12. 数据统计查询
SELECT '数据插入完成！' as 完成信息;
SELECT '数据规模：' as 数据统计;
SELECT CONCAT('用户：', COUNT(*)) FROM users
UNION ALL
SELECT CONCAT('设备：', COUNT(*)) FROM equipments
UNION ALL
SELECT CONCAT('预约记录：', COUNT(*)) FROM reservations
UNION ALL
SELECT CONCAT('借用记录：', COUNT(*)) FROM borrow_records
UNION ALL
SELECT CONCAT('损坏记录：', COUNT(*)) FROM damage_records
UNION ALL
SELECT CONCAT('维修记录：', COUNT(*)) FROM maintenance_records;

-- 13. 验证数据完整性
SELECT '外键约束验证' as 验证项目;
SELECT 
    '设备表外键错误数量' as 验证项,
    COUNT(*) as 数量
FROM equipments e
LEFT JOIN equipment_types et ON e.type_id = et.type_id
WHERE et.type_id IS NULL
UNION ALL
SELECT 
    '预约记录用户外键错误数量',
    COUNT(*) 
FROM reservations r
LEFT JOIN users u ON r.user_id = u.user_id
WHERE u.user_id IS NULL
UNION ALL
SELECT 
    '预约记录设备外键错误数量',
    COUNT(*) 
FROM reservations r
LEFT JOIN equipments e ON r.equipment_id = e.equipment_id
WHERE e.equipment_id IS NULL
UNION ALL
SELECT 
    '借用记录用户外键错误数量',
    COUNT(*) 
FROM borrow_records br
LEFT JOIN users u ON br.user_id = u.user_id
WHERE u.user_id IS NULL
UNION ALL
SELECT 
    '借用记录设备外键错误数量',
    COUNT(*) 
FROM borrow_records br
LEFT JOIN equipments e ON br.equipment_id = e.equipment_id
WHERE e.equipment_id IS NULL
UNION ALL
SELECT 
    '损坏记录借用记录外键错误数量',
    COUNT(*) 
FROM damage_records dr
LEFT JOIN borrow_records br ON dr.borrow_record_id = br.record_id
WHERE br.record_id IS NULL
UNION ALL
SELECT 
    '维修记录设备外键错误数量',
    COUNT(*) 
FROM maintenance_records mr
LEFT JOIN equipments e ON mr.equipment_id = e.equipment_id
WHERE e.equipment_id IS NULL;

SELECT NOW() as 数据更新时间;



